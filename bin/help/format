#!/usr/bin/env node

var path = require('path');
var pkg = path.normalize(
  path.join(__dirname, '..', '..', 'package.json'));
var cli = require('../..'), help = cli.help;
var formats = cli.doc.fmt.formats;
var styles = cli.doc.fmt.styles;
var defs = {
  commands: {
    format: function(info) {
      help.call(this, true);
      console.info('formats: %s', formats.join(', '));
      console.info('styles: %s', styles.join(', '));
    }
  }
}
cli(pkg)
  .configure({help: {style: 'markdown'}})
  .use(cli.middleware.color)
  .load(path.join(__dirname, 'format.md'), defs, function(cli) {
    this
      .once('format', function(req, arg, value) {
        this.configure().help.style = value;
      })
      .on('complete', function(req) {
        //console.dir(req);
        if(!req.command) help.call(this);
      })
      .version()
      .help()
      .parse();
  })
